
/**
 * jquery.verySimpleImageViewer.js
 * Ver. : 1.0.1 
 * last update: 04/08/2018
 * Author: meshesha , https://github.com/meshesha
 * LICENSE: MIT
 * url:https://meshesha.github.io/verySimpleImageViewer
 */
!function(e){function t(e,t){if("number"==typeof e)return e;var o=e.indexOf(t);return parseInt(e.substring(0,-1!=o?o:e.length))}function o(e){var t=0,o=0;return e||(e=window.event),e.pageX||e.pageY?(t=e.pageX,o=e.pageY):(e.clientX||e.clientY)&&(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,o=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),[t,o]}e.fn.verySimpleImageViewer=function(n){var i=e.extend({imageSource:"",frame:["720px","480px",!0],maxZoom:"300%",zoomFactor:"10%",saveZoomPos:!0,mouse:!0,keyboard:!0,toolbar:!0,rotateToolbar:!1},n),r=i.imageSource,a=i.frame,l=i.maxZoom,s=i.zoomFactor,m=i.saveZoomPos,d=i.mouse,u=i.keyboard,c=i.toolbar,p=i.rotateToolbar,f=this,A=e(this)[0],g=A.id,v=null,h=0;f.frameElement=null;var y,w,E=0,C=null,b=5;if(f.getFrameDimension=function(){return[f.frameElement.clientWidth,f.frameElement.clientHeight]},f.setDimension=function(e,t){v.width=Math.round(e),v.height=Math.round(t)},f.getDimension=function(){return[v.width,v.height]},f.setPosition=function(e,t){v.style.left=Math.round(e)+"px",v.style.top=Math.round(t)+"px"},f.getPosition=function(){return[t(v.style.left,"px"),t(v.style.top,"px")]},f.setMouseCursor=function(){var e=f.getDimension(),t=f.getFrameDimension(),o="crosshair";e[0]>t[0]&&e[1]>t[1]?o="move":e[0]>t[0]?o="e-resize":e[1]>t[1]&&(o="n-resize"),v.style.cursor=o},f.maxZoomCheck=function(e,t){if(void 0===e||void 0===t){var o=f.getDimension();e=o[0],t=o[1]}return"number"==typeof l?e/y>l||t/w>l:"object"==typeof l?e>l[0]||t>l[1]:void 0},f.fitToFrame=function(e,t){void 0!==e&&void 0!==t||(e=y,t=w);var o,n,i=f.getFrameDimension();return o=i[0],(n=Math.round(o*t/e))>i[1]&&(n=i[1],o=Math.round(n*e/t)),[o,n]},f.getZoomLevel=function(){return E},f.zoomTo=function(e,t,o){var n=f.getFrameDimension();if(e<0||t<0||o<0||t>=n[0]||o>=n[1])return!1;for(var i=f.fitToFrame(y,w),r=e;r>0;r--)i[0]*=s,i[1]*=s;var a=v.width,l=v.height,d=f.getPosition();return d[0]-=(t-d[0])*(i[0]/a-1),d[1]-=(o-d[1])*(i[1]/l-1),d=f.centerImage(i[0],i[1],d[0],d[1]),!f.maxZoomCheck(i[0],i[1])&&(E=e,f.setDimension(i[0],i[1]),f.setPosition(d[0],d[1]),f.setMouseCursor(),m&&"undefined"!=typeof Storage&&(localStorage.setItem(g+"_zoomlvl",E),localStorage.setItem(g+"_dimensionx",i[0]),localStorage.setItem(g+"_dimensiony",i[1]),localStorage.setItem(g+"_positionx",d[0]),localStorage.setItem(g+"_positiony",d[1])),!0)},f.centerImage=function(e,t,o,n){var i;void 0!==e&&void 0!==t||(e=(i=f.getDimension())[0],t=i[1]);void 0!==o&&void 0!==n||(o=(i=f.getPosition())[0],n=i[1]);var r=f.getFrameDimension();return e<=r[0]&&(o=Math.round((r[0]-e)/2)),t<=r[1]&&(n=Math.round((r[1]-t)/2)),e>r[0]&&(o>0?o=0:o+e<r[0]&&(o=r[0]-e)),t>r[1]&&(n>0?n=0:n+t<r[1]&&(n=r[1]-t)),[o,n]},f.rotate=function(t,o){"1"==t?h+=90:h-=90,o?e("."+f.frameElement.className+" .jqvsiv_main_image_content").css("transform","rotate(0deg)"):e("."+f.frameElement.className+" .jqvsiv_main_image_content").css("transform","rotate("+h+"deg)")},f.reset=function(){var e=f.fitToFrame(y,w),t=f.centerImage(e[0],e[1],0,0);f.setDimension(e[0],e[1]),f.setPosition(t[0],t[1]),E=0,f.rotate("1",!0)},f.onmousewheel=function(e,t,n){if(f.frameElement.focus(),e?e.preventDefault&&e.preventDefault():(e=window.event).returnValue=!1,E+n>=0){var i=o(e),r=function(e){var t,o;if(objectCopy=e,e.offsetParent){t=o=0;do{t+=e.offsetLeft,""!=e.style.borderLeftWidth?t+=parseInt(e.style.borderLeftWidth):e.style.borderLeftWidth="0px",o+=e.offsetTop,""!=e.style.borderTopWidth?o+=parseInt(e.style.borderTopWidth):e.style.borderTopWidth="0px"}while(e=e.offsetParent)}return[t-parseInt(objectCopy.style.borderLeftWidth),o-parseInt(objectCopy.style.borderLeftWidth)]}(f.frameElement);f.zoomTo(E+n,i[0]-r[0],i[1]-r[1])}},f.onmousemove=function(e){e?e.preventDefault&&e.preventDefault():(e=window.event).returnValue=!1;var t=o(e),n=f.getPosition();n[0]+=t[0]-C[0],n[1]+=t[1]-C[1],C=t,n=f.centerImage(v.width,v.height,n[0],n[1]),f.setPosition(n[0],n[1]),m&&"undefined"!=typeof Storage&&(localStorage.setItem(g+"_positionx",n[0]),localStorage.setItem(g+"_positiony",n[1]))},f.onmouseup_or_out=function(e){e?e.preventDefault&&e.preventDefault():(e=window.event).returnValue=!1,v.onmousemove=v.onmouseup=v.onmouseout=null,v.onmousedown=f.onmousedown},f.onmousedown=function(e){f.frameElement.focus(),e?e.preventDefault&&e.preventDefault():(e=window.event).returnValue=!1,C=o(e),v.onmousemove=f.onmousemove,v.onmouseup=v.onmouseout=f.onmouseup_or_out},f.onkeypress=function(e){var t;window.event?(t=(e=window.event).keyCode,e.returnValue=!1):e.which&&(t=e.which,e.preventDefault()),t=String.fromCharCode(t);var o=f.getPosition();"a"==t?o[0]+=b:"w"==t?o[1]+=b:"d"==t?o[0]-=b:"s"==t?o[1]-=b:"c"==t||"C"==t?f.reset():"="==t||"+"==t||"x"==t||"X"==t?f.zoomTo(E+1,f.frameElement.clientWidth/2,f.frameElement.clientHeight/2):("-"==t||"z"==t||"Z"==t)&&E>0&&f.zoomTo(E-1,f.frameElement.clientWidth/2,f.frameElement.clientHeight/2),"a"!=t&&"w"!=t&&"d"!=t&&"s"!=t||(o=f.centerImage(v.width,v.height,o[0],o[1]),f.setPosition(o[0],o[1]),b+=2,m&&"undefined"!=typeof Storage&&(localStorage.setItem(g+"_positionx",o[0]),localStorage.setItem(g+"_positiony",o[1])))},f.onkeyup=function(e){b=5},f.setZoomProp=function(e,o){null==e&&(s=10),s=1+t(e,"%")/100,"string"==typeof o?l=t(o,"%")/100:"object"==typeof o&&null!=o?(l[0]=t(o[0],"px"),l[1]=t(o[1],"px")):l="300%"},f.initImage=function(){y=v.width,w=v.height;var e=f.fitToFrame(y,w);f.setDimension(e[0],e[1]),1==a[2]&&(f.frameElement.style.width=Math.round(e[0])+"px"),1==a[3]&&(f.frameElement.style.height=Math.round(e[1])+"px");var t=f.centerImage(e[0],e[1],0,0);if(f.setPosition(t[0],t[1]),f.setMouseCursor(),d&&((new function(){var e=function(e,t,o){};this.wheelHandler=function(t){var o=0;t||(t=window.event),t.wheelDelta?o=t.wheelDelta/120:t.detail&&(o=-t.detail/3),t.preventDefault&&t.preventDefault(),t.returnValue=!1,o&&e(t,this,o)},this.init=function(t,o){t.addEventListener&&t.addEventListener("DOMMouseScroll",this.wheelHandler,!1),t.onmousewheel=this.wheelHandler,e=o},this.setCallback=function(t){e=t}}).init(v,f.onmousewheel),v.onmousedown=f.onmousedown),u&&(f.frameElement.onkeypress=f.onkeypress,f.frameElement.onkeyup=f.onkeyup),c&&f.loadToolbar(f),m&&"undefined"!=typeof Storage){var o=localStorage.getItem(g+"_zoomlvl"),n=localStorage.getItem(g+"_dimensionx"),i=localStorage.getItem(g+"_dimensiony"),r=localStorage.getItem(g+"_positionx"),l=localStorage.getItem(g+"_positiony");null!==o&&(E=parseInt(o),f.setDimension(n,i),f.setPosition(r,l),f.setMouseCursor())}},f.frameElement=document.createElement("div"),f.frameElement.className="image_viewer_inner_container",f.frameElement.style.width=a[0],f.frameElement.style.height=a[1],f.frameElement.style.border="0px solid #000",f.frameElement.style.margin="0px",f.frameElement.style.padding="0px",f.frameElement.style.overflow="hidden",f.frameElement.style.position="relative",f.frameElement.style.zIndex=2,f.frameElement.tabIndex=1,f.setZoomProp(s,l),null!=v)null!=A?(v.parentNode.removeChild(v),A.appendChild(f.frameElement)):v.parentNode.replaceChild(f.frameElement,v),v.style.margin=v.style.padding="0",v.style.borderWidth="0px",v.style.position="absolute",v.style.zIndex=3,f.frameElement.appendChild(v);else{null!=A&&A.appendChild(f.frameElement);var I=document.createElement("div");I.className="jqvsiv_main_image_content",(v=document.createElement("img")).style.position="absolute",v.style.zIndex=3,I.appendChild(v),f.frameElement.appendChild(I),v.onload=f.initImage,v.src=r}f.loadToolbar=function(e){var t=document.createElement("div");t.className="jqvsiv_toolbar";var o=function(e){var t;return e.keyCode?(t=e.keyCode,e.returnValue=!1):e.which&&(t=e.which,e.preventDefault()),13==t},n=document.createElement("img");n.className="jqvsiv_toolbarButton",n.title="Zoom in",n.tabIndex="1",n.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAABN0lEQVRIic3WMW6DMBQGYN+EqhGJJYZMvUMHpByAKceIKpYuGUqmLjFESIm6pQORgpSJwNYoYsiQsSfB9utSUBKZYgcs1dI/4s+8Z2NQf54MMUnzAUk5Jil0kd+58v48GSJM0ryriQXJUZcrF70J0rh6wCSF/wVYfgaWn+kBRusjUMaBMg72at89MN6eoBxOGIPpRXqBhxdfCmkFyCC1wGh9hPH2VOXt67sCprsDOGFcxV4maoDlZ0AZB9lRUAZ4ttEL9NxAWK7aEtmr/VUZprtDbYme3z9re/Jnk00vqh50wljYZFEukcZdVCIqwCUitU1NL1IGSkT6HNjLBArKoKDsquZNUfuazjbQcwPpydWBm8ZrAVSRu69MGcSYBLzVpd+EGO7ijNr+togQYxJww12cH18/nn4Aw1rF5Pti/U4AAAAASUVORK5CYII=",n.onclick=n.onkeypress=function(t){if("keypress"!=(t=t||window.event).type||o(t)){var n=e.getFrameDimension();e.zoomTo(e.getZoomLevel()+1,n[0]/2,n[1]/2)}};var i=document.createElement("img");i.className="jqvsiv_toolbarButton",i.title="Zoom out",i.tabIndex="1",i.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAA3klEQVRIiWNQm7FPX2PmgbPqMw/805h54D81MNSss2oz9ukzaMw8cJZaBmPBZxmo6XJsPmGgoev/a8w88H/UglELaGiB/+rT/xO3XCQK+68+TZoF2rMO/v/z999/YsHvP3//a/Rtoq0FyrWz/6v2biQ+iHwWHfgfPW8rUdhj8pr/CtWz/itUz8KwBG8kq/ZsgGskBSNbQjAVUWoJUcmUEkuIzgfkWkJSRiPHEpJzMqmWkFVUkGIJ2VUmMZbIV87+R1GlT8gS+do5VxkobbZgs0S+cvY/+do5V5WalpgCAJUZolx/yaTFAAAAAElFTkSuQmCC",i.onclick=i.onkeypress=function(t){if("keypress"!=(t=t||window.event).type||o(t)){var n=e.getFrameDimension();e.zoomTo(e.getZoomLevel()-1,n[0]/2,n[1]/2)}};var r=document.createElement("img");if(r.className="jqvsiv_toolbarButton",r.title="Center image",r.tabIndex="1",r.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAABmklEQVRIic3WvWrCUBQH8LyJomiCQwO+Q7u0bl0FX0MsqCA6CEIXa+LXJqhQQUEc2pBqEWkJlXQrzSA6VKEfLkUo5t+hNURNNNEUeuGMOb+bc8/hXsKd4WiK4QWS4WWK4WFF/OYS3BmOJiiGF6xKrBECYeXOtf6E+MPdg2J4/H+AzrURaPStBU4q9/AWOqBzbXSGr5jLMvzVrnVAU5rg4eUD3dEbAODmaQgynIcrVd8f8LA8prMvLNbt8whkOA97iIU9xK4hpoHTSwHqJQzG8ESLCrCKmAaSPUlJ/v45Q0OUcHheXQLUiGkgci0i3urBl67BcZZdS7yKbAU87E9Zkj0JEe4R1AUHZ6y0MbE6dIHjyh2a0mTpQOOtHpyxkilEF/AWOuiPp0sH6kvXYA+xphBdgM61lT5fHKi65kYRTWAxoYs+FwZjNERp7WMjiCYQaPQxl2VlQj3RIo40WtEIolsif7W7NKGbYhOysU1dqbrhdtRDts7BvoihK3NXxBbMyoYv/V0QR6IsEmaeLUYRWzArOxJlkUxfHXwDNFegvBR/iaAAAAAASUVORK5CYII=",r.onclick=r.onkeypress=function(t){("keypress"!=(t=t||window.event).type||o(t))&&e.reset()},p){var a=document.createElement("img");a.className="jqvsiv_toolbarButton",a.title="Center image",a.tabIndex="1",a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAB1ElEQVRIieXWwUvbYBjH8fwndRW7CoID3Wn3nYSdxIviQQa7bHdp62GIXvTiEBpTqUyZssKglk4UtJlawUmKshUtgtV6kMEs2m2lmpjvLrbM2TdrY3Yy8FwS+H3e503e943kCa60emVVeyirpldWcaKuszRPcKVV8sqq5lRwldIkJ0derRPpP44er6xyj4BXS2mKuoGcOuLR5KqzwJO3G6znTjEB48rk16XOSDLjDPBi4Quiq2k0ejegL75TCTvOFzCBC8Pg8PScrlCM2a1deiMb9oGD/E8A3iRSdIfjZL+f44+u4fYr9E4tVHCPRSdC4FlkC4CzYonGgEKDb+JGuf0KZ8USAB3jH4TTJQReLn0FYDN7ciu8XJvZEwCezyzS4JuoigiBnvltAHL5ghDI5QsAPB2LVO79jQiBFuUTPy50ALrD8VvhPeGPAJR0gwf+m8/+RCxf8nByH66//YFYkvbhadqGphmIJbkyTQB80bWq3ZURS6BZVpn6nBGug/daRjh9ZeTfKzmYoG9OZXnviOKlTkk3SOW+0anMW4aXq7a9KJigcfBdTYH2gDsg9W3XNpD6j8w6EFe/Yto79GtEXIFQWrL922KBuPoV0xUIpd2vZx7/Bh7Ty4bjzETnAAAAAElFTkSuQmCC",a.onclick=a.onkeypress=function(t){("keypress"!=(t=t||window.event).type||o(t))&&e.rotate("1")};var l=document.createElement("img");l.className="jqvsiv_toolbarButton",l.title="Center image",l.tabIndex="1",l.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAACQklEQVRIie3W3U9SYRwH8POfcEDj0Mtcq7XVP9BVra2tyy5aba1/wQOI2dxq3rQSeQ4qIdiLthZtNcSXc0wj8zgQCSEqmHOYLwnMCBU559uFwxREXoK7nu13+/38nme/59lDMcaRJjXhvYxJkDREQC2KMQmSmvBexjjSRKkJ761VcH6pCe+latn5YTuh6hWeq/9AbYBbb+cwubi+ubG9s5PYykhDkVVcfzP7b8BxIuDSgAjiXQAABJZ+Sh3DIh7xHoRX4llJlmFyzy9UDVwZFAEAsY10+pkYRKO+G+fv9+NMex9UWjN63X7IMnB74H2gKuCO04/cevc5Aprl8NLzBR3DImiWg0prxtfVBJyBKBru2T9WDOgmwsup7Qx6Pvhx4UF/AUCzHCxuP+K/N0GzXFGkKHCKjKcbW3vDuTCa5fB0Oojp6A+cbbeBZjn0TQX2AJrl0NBmK0COnCLGOBpX6syLuYATrRY8nwnhKnFA3dKDWOIXnIEo9jeRj5QcU+axK3bTNpRSac17Icf03XgxE0JWknHx4eABYBf5e1wlgRuvxVhWkhBaXgc34YN1KoDIWhKZrAStY7IgPB8p66Jds7jmHL5v+L6WxFIyhaH5KC53vioavh8pC2CIICvb7J9KBR5WZb9FjGlcUhmsYt2AXWQsSxusnroBGiJAY+IzSoN1tmyAIYJcKcJ0jW0pW574S4UrWCJRDBF8Fe+CCGC6+LRCbwkeCTRzQepkp+t01d8W02hKqTv4nOQ6VzRzQdVd+7k/U9So5+j1RlYAAAAASUVORK5CYII=",l.onclick=l.onkeypress=function(t){("keypress"!=(t=t||window.event).type||o(t))&&e.rotate("-1")}}t.appendChild(n),t.appendChild(i),p&&(t.appendChild(a),t.appendChild(l)),t.appendChild(r),e.frameElement.appendChild(t)}}}(jQuery);
